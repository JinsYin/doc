# VLAN

## 广播问题和安全问题

* 交换机尽管比集线器智能一些，但依然存在广播问题，当机器连接的机器较多时，广播一大堆性能就会随之下降
* 同一个广播域中，包会广播到整个局域网，必然也存在安全问题

两种解决方法：

* **物理隔离** - 每个部门有单独的交换机，配置单独的子网，部门之间的通信使用路由器
* **虚拟隔离** - 即虚拟局域网（**VLAN**）；使用 VLAN，一个交换机会连接属于多个局域网的机器

## 工作原理

交换机如何区分哪个机器属于哪个局域网？

![VLAN 数据帧](.images/vlan-frame.png)

1. 网络管理员可以设置交换机每个口所属的 VLAN
2. 网络设备需要在原来的二层数据帧 Frame 的头上增加一个 TAG，TAG 中包含一个 VLAN ID（共 `12` 位，意味着最多可以划分 `4096` 个 VLAN），用于标识网络设备属于哪个局域网
3. 如果交换机支持 VLAN，会将数据帧 Frame 的头取下来，识别 VLAN ID；这样只有相同 VLAN 的包才会相互转发，不同 VLAN 的包无法看到

交换机之间如何连接？

对于支持 VLAN 的交换机，可以通过一种叫作 **Trunk 口**（Trunk：树杈） 的端口相互连接，Trunk 口可以转发属于任何 VLAN 的包。
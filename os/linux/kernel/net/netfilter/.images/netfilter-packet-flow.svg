<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="svg2" width="1450" height="475" version="1.0"><defs id="defs4"><linearGradient id="linearGradient4281"><stop id="stop4283" offset="0" stop-color="#cfcfcf" stop-opacity="1"/><stop id="stop4285" offset="1" stop-color="#3f3f3f" stop-opacity="1"/></linearGradient><linearGradient id="linearGradient4094"><stop id="stop4096" offset="0" stop-color="#fffe99" stop-opacity="1"/><stop id="stop4098" offset="1" stop-color="#ffffe1" stop-opacity="1"/></linearGradient><linearGradient id="linearGradient4843"><stop id="stop4845" offset="0" stop-color="#ff99bd" stop-opacity="1"/><stop id="stop4847" offset="1" stop-color="#ffe1ec" stop-opacity="1"/></linearGradient><linearGradient id="linearGradient4827"><stop id="stop4829" offset="0" stop-color="#81b9ff" stop-opacity="1"/><stop id="stop4831" offset="1" stop-color="#e1efff" stop-opacity="1"/></linearGradient><linearGradient id="linearGradient4819"><stop id="stop4821" offset="0" stop-color="#c1ffa6" stop-opacity="1"/><stop id="stop4823" offset="1" stop-color="#ebffe1" stop-opacity="1"/></linearGradient><linearGradient id="linearGradient3422"><stop id="stop3424" offset="0" stop-color="#fff" stop-opacity="1"/><stop id="stop3426" offset="1" stop-color="#d0d0d0" stop-opacity="1"/></linearGradient><linearGradient id="linearGradient3414"><stop id="stop3416" offset="0" stop-color="#8080ff" stop-opacity="1"/><stop id="stop3418" offset="1" stop-color="#0000a0" stop-opacity="1"/></linearGradient><linearGradient id="linearGradient3406"><stop id="stop3408" offset="0" stop-color="#bdff99" stop-opacity="1"/><stop id="stop3410" offset="1" stop-color="#00e000" stop-opacity="1"/></linearGradient><marker id="Arrow2Mend" orient="auto" overflow="visible" refX="0" refY="0"><path id="path3563" fill-rule="evenodd" stroke-linejoin="round" stroke-width=".625" d="M 8.7185878,4.0337352 -2.2072895,0.01601326 8.7185884,-4.0017078 c -1.7454984,2.3720609 -1.7354408,5.6174519 -6e-7,8.035443 z" font-size="12" transform="scale(-0.6,-0.6)"/></marker><linearGradient id="linearGradient3425" x1="350.063" x2="350.063" y1="776.875" y2="787" gradientTransform="matrix(0.9876543,0,0,1.0126582,-315.74074,-106.314)" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient3414"/><linearGradient id="linearGradient4398" x1="649.938" x2="649.938" y1="776.875" y2="787.25" gradientTransform="matrix(1.0126582,0,0,0.9876543,-628.16456,-106.88593)" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient3406"/><linearGradient id="linearGradient4825" x1="185" x2="185" y1="541.479" y2="666.479" gradientTransform="translate(35,198.52148)" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient4819"/><linearGradient id="linearGradient4833" x1="185" x2="185" y1="676.479" y2="766.479" gradientTransform="translate(35,198.52148)" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient4827"/><linearGradient id="linearGradient4849" x1="185" x2="185" y1="226.479" y2="271.479" gradientTransform="translate(35,458.52148)" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient4094"/><linearGradient id="linearGradient3307" x1="750" x2="750" y1="776.875" y2="812.125" gradientTransform="matrix(0.2,0,0,0.28571429,-120,358)" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient4281"/><linearGradient id="linearGradient4092" x1="185" x2="185" y1="226.479" y2="271.479" gradientTransform="translate(35,388.52148)" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient4843"/><linearGradient id="linearGradient4234" x1="370" x2="370" y1="776.875" y2="787.125" gradientTransform="translate(-50,148.52148)" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient3414"/><linearGradient id="linearGradient4236" x1="670" x2="670" y1="776.479" y2="786.479" gradientTransform="translate(-90,148.52148)" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient3406"/><linearGradient id="linearGradient4238" x1="670" x2="670" y1="786.479" y2="806.479" gradientTransform="translate(-90,148.52148)" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient3422"/><linearGradient id="linearGradient4240" x1="750" x2="750" y1="777" y2="807" gradientTransform="translate(-105,148)" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient3422"/><linearGradient id="linearGradient4275" x1="750" x2="750" y1="776.875" y2="812.125" gradientTransform="matrix(0.2,0,0,0.28571429,-120,378)" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient3422"/><linearGradient id="linearGradient4291" x1="750" x2="750" y1="777" y2="807" gradientTransform="translate(-300,53)" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient4281"/></defs><metadata id="metadata7"/><g id="layer2" display="inline" transform="translate(0,-525)"><rect id="rect13708" width="1095" height="90" x="210" y="875" fill="url(#linearGradient4833)" fill-opacity="1" fill-rule="evenodd" stroke="#000" stroke-dasharray="none" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="bevel" stroke-miterlimit="4" stroke-opacity="1" stroke-width=".2" display="inline"/><rect id="rect13706" width="1095" height="125" x="210" y="740" fill="url(#linearGradient4825)" fill-opacity="1" fill-rule="evenodd" stroke="#000" stroke-dasharray="none" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="bevel" stroke-miterlimit="4" stroke-opacity="1" stroke-width=".2" display="inline"/><rect id="rect3413" width="1095" height="60" x="210" y="670" fill="url(#linearGradient4849)" fill-opacity="1" stroke="#000" stroke-dasharray="none" stroke-linecap="square" stroke-linejoin="bevel" stroke-miterlimit="4" stroke-opacity="1" stroke-width=".2" display="inline"/><rect id="rect4090" width="1095" height="45" x="210" y="615" fill="url(#linearGradient4092)" fill-opacity="1" stroke="#000" stroke-dasharray="none" stroke-linecap="square" stroke-linejoin="bevel" stroke-miterlimit="4" stroke-opacity="1" stroke-width=".2" display="inline"/></g><g id="layer3" display="inline" transform="translate(0,-525)"><rect id="rect3439" width="200" height="370" x="690" y="605" fill="#000" fill-opacity=".09" fill-rule="evenodd" stroke="#000" stroke-dasharray="none" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="bevel" stroke-miterlimit="4" stroke-opacity="1" stroke-width=".2" display="inline" opacity=".86"/><rect id="rect13716" width="395" height="370" x="900" y="605" fill="#000" fill-opacity=".09" fill-rule="evenodd" stroke="#000" stroke-dasharray="none" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="bevel" stroke-miterlimit="4" stroke-opacity="1" stroke-width=".2" display="inline" opacity=".86"/><rect id="rect3419" width="460" height="370" x="220" y="605" fill="#000" fill-opacity=".09" fill-rule="evenodd" stroke="#000" stroke-dasharray="none" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="bevel" stroke-miterlimit="4" stroke-opacity="1" stroke-width=".2" display="inline" opacity=".86"/></g><g id="layer1" display="inline" transform="translate(0,-525)"><use id="use3237" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(-195,-95)" xlink:href="#rect2180"/><use id="use3239" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(-195,-95)" xlink:href="#rect3165"/><use id="use3229" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(-65,-95)" xlink:href="#rect2180"/><use id="use3231" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(0,-95)" xlink:href="#rect2180"/><use id="use3219" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(-65,-95)" xlink:href="#rect3165"/><use id="use3221" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(0,-95)" xlink:href="#rect3165"/><rect id="use3346" width="50" height="25" x="425" y="830" fill="url(#linearGradient4291)" fill-opacity="1" fill-rule="evenodd" stroke="#000" stroke-dasharray="none" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="bevel" stroke-miterlimit="4" stroke-opacity="1" stroke-width=".25" display="inline" rx="10" ry="10"/><use id="use26146" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(139.8,-300)" xlink:href="#rect25154"/><use id="use3392" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(-345,-230)" xlink:href="#rect25154"/><rect id="rect6659" width="50" height="10" x="295" y="925" fill="url(#linearGradient4234)" fill-opacity="1" fill-rule="evenodd" stroke="#000" stroke-dasharray="none" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="bevel" stroke-miterlimit="4" stroke-opacity="1" stroke-width=".25" display="inline"/><use id="use13788" width="1488.189" height="1052.362" x="0" y="0" display="inline" transform="translate(-195,0)" xlink:href="#rect2180"/><use id="use13790" width="1488.189" height="1052.362" x="0" y="0" display="inline" transform="translate(-195,0)" xlink:href="#rect3165"/><use id="use13826" width="1488.189" height="1052.362" x="0" y="0" stroke="none" display="inline" transform="translate(-65,0)" xlink:href="#rect6659"/><use id="use26140" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(-465,0)" xlink:href="#rect25154"/><use id="use3490" width="1510" height="1052" x="0" y="0" display="inline" transform="translate(-325,0)" xlink:href="#rect3165"/><use id="use3492" width="1510" height="1052" x="0" y="0" display="inline" transform="translate(-260,0)" xlink:href="#rect3165"/><use id="use2708" width="1610" height="1052" x="0" y="0" display="inline" transform="translate(-530,0)" xlink:href="#rect25154"/><use id="use26136" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(0,-95)" xlink:href="#rect25154"/><rect id="rect2180" width="50" height="10" x="555" y="925" fill="url(#linearGradient4236)" fill-opacity="1" fill-rule="evenodd" stroke="#000" stroke-dasharray="none" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="bevel" stroke-miterlimit="4" stroke-opacity="1" stroke-width=".25" display="inline"/><rect id="rect3165" width="50" height="15" x="555" y="935" fill="url(#linearGradient4238)" fill-opacity="1" fill-rule="evenodd" stroke="#000" stroke-dasharray="none" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="bevel" stroke-miterlimit="4" stroke-opacity="1" stroke-width=".25" display="inline"/><use id="use3269" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(65,-135)" xlink:href="#rect2180"/><use id="use3271" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(65,-135)" xlink:href="#rect3165"/><use id="use7632" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(325,-40)" xlink:href="#rect6659"/><use id="use13764" width="1488.189" height="1052.362" x="0" y="0" display="inline" transform="translate(-65,0)" xlink:href="#rect2180"/><use id="use13766" width="1488.189" height="1052.362" x="0" y="0" display="inline" transform="translate(-65,0)" xlink:href="#rect3165"/><rect id="rect25154" width="50" height="25" x="620" y="925" fill="url(#linearGradient4240)" fill-opacity="1" fill-rule="evenodd" stroke="#000" stroke-dasharray="none" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="bevel" stroke-miterlimit="4" stroke-opacity="1" stroke-width=".25" display="inline" rx="10" ry="10"/><use id="use3376" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(65,-175)" xlink:href="#rect2180"/><use id="use3378" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(65,-175)" xlink:href="#rect3165"/><use id="use3818" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(0,-230)" xlink:href="#rect25154"/><use id="use3484" width="1510" height="1052" x="0" y="0" display="inline" transform="translate(65,-40)" xlink:href="#rect3165"/><use id="use3225" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(210,-95)" xlink:href="#rect3165"/><use id="use3235" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(210,-95)" xlink:href="#rect2180"/><use id="use7638" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(210,-40)" xlink:href="#rect2180"/><use id="use7640" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(210,-40)" xlink:href="#rect3165"/><use id="use7694" width="1052.362" height="744.094" x="0" y="0" display="inline" font-family="Arial" font-size="20" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="start" transform="translate(210,0)" writing-mode="lr-tb" xlink:href="#rect2180" style="text-align:start;line-height:100%"/><use id="use7696" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(210,0)" xlink:href="#rect3165"/><use id="use3401" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(275,0)" xlink:href="#rect3165"/><use id="use3403" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(275,-40)" xlink:href="#rect3165"/><use id="use3405" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(275,-95)" xlink:href="#rect3165"/><use id="use3407" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(275,0)" xlink:href="#rect2180"/><use id="use3409" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(275,-40)" xlink:href="#rect2180"/><use id="use3411" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(275,-95)" xlink:href="#rect2180"/><use id="use6560" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(420,-170)" xlink:href="#rect2180"/><use id="use6562" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(420,-170)" xlink:href="#rect3165"/><use id="use3363" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(420,-95)" xlink:href="#rect3165"/><use id="use12671" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(420,0)" xlink:href="#rect2180"/><use id="use12673" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(420,0)" xlink:href="#rect3165"/><use id="use3441" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(420,-130)" xlink:href="#rect3165"/><use id="use3361" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(420,-95)" xlink:href="#rect2180"/><use id="use3790" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(420,-130)" xlink:href="#rect2180"/><use id="use3460" width="1510" height="1052" x="0" y="0" display="inline" transform="translate(420,-40)" xlink:href="#rect3165"/><use id="use3464" width="1510" height="1052" x="0" y="0" display="inline" transform="translate(420,-40)" xlink:href="#rect2180"/><use id="use13744" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(485,0)" xlink:href="#rect2180"/><use id="use3377" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(485,-95)" xlink:href="#rect2180"/><use id="use3379" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(485,-95)" xlink:href="#rect3165"/><use id="use13746" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(485,0)" xlink:href="#rect3165"/><use id="use3800" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(485,-130)" xlink:href="#rect2180"/><use id="use3802" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(485,-130)" xlink:href="#rect3165"/><use id="use3462" width="1510" height="1052" x="0" y="0" display="inline" transform="translate(485,-40)" xlink:href="#rect3165"/><use id="use3466" width="1510" height="1052" x="0" y="0" display="inline" transform="translate(485,-40)" xlink:href="#rect2180"/><use id="use3303" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(550,-170)" xlink:href="#rect2180"/><use id="use3305" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(550,-170)" xlink:href="#rect3165"/><use id="use7636" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(810,-40)" xlink:href="#rect6659"/><use id="use26138" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(485,-130)" xlink:href="#rect25154"/><use id="use3478" width="1510" height="1052" x="0" y="0" display="inline" transform="translate(550,-40)" xlink:href="#rect3165"/><use id="use3426" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(420,-230)" xlink:href="#rect25154"/><use id="use3820" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(290,-170)" xlink:href="#rect25154"/><use id="use7700" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(405,0)" xlink:href="#rect6659"/><use id="use3486" width="1510" height="1052" x="0" y="0" display="inline" transform="translate(145,0)" xlink:href="#rect3165"/><use id="use8743" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(615,0)" xlink:href="#rect6659"/><use id="use3488" width="1510" height="1052" x="0" y="0" display="inline" transform="translate(355,0)" xlink:href="#rect3165"/><use id="use7680" width="1052.362" height="744.094" x="0" y="0" display="inline" transform="translate(875,-40)" xlink:href="#rect6659"/><use id="use3482" width="1510" height="1052" x="0" y="0" display="inline" transform="translate(615,-40)" xlink:href="#rect3165"/><use id="use4379" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(550,-95)" xlink:href="#rect25154"/><use id="use3503" width="1510" height="1052" x="0" y="0" display="inline" transform="translate(679.99268,-40.02685)" xlink:href="#rect3165"/><use id="use3507" width="1510" height="1052" x="0" y="0" display="inline" transform="translate(939.99268,-40.02685)" xlink:href="#rect6659"/><use id="use3425" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(695,0)" xlink:href="#rect25154"/><use id="use2722" width="1610" height="1052" x="0" y="0" display="inline" transform="translate(760,0)" xlink:href="#rect25154"/><use id="use3339" width="1400" height="475" x="0" y="0" transform="translate(-530,-95)" xlink:href="#rect25154"/><use id="use3347" width="1400" height="475" x="0" y="0" transform="translate(-595,0)" xlink:href="#rect25154"/><use id="use4138" width="1400" height="475" x="0" y="0" transform="translate(760,-95)" xlink:href="#rect25154"/><use id="use4293" width="1450" height="475" x="0" y="0" transform="translate(0,95)" xlink:href="#use3346"/><use id="use4295" width="1450" height="475" x="0" y="0" transform="translate(615,-75)" xlink:href="#use3346"/></g><g id="layer6" display="inline" transform="translate(0,-525)"><text id="text13792" x="384.727" y="933.114" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan13794" x="384.727" y="933.114">raw</tspan></text><text id="text13804" x="319.705" y="933.961" fill="#fff" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan13806" x="319.705" y="933.961">nat</tspan></text><text id="text13816" x="254.883" y="933.842" fill="#fff" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan13818" x="254.883" y="933.842">broute</tspan></text><text id="text13820" x="255.01" y="945.027" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan13822" x="255.01" y="945.027">brouting</tspan></text><text id="text14844" x="179.883" y="936.021" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan14846" x="179.883" y="936.021">bridge</tspan><tspan id="tspan14848" x="179.883" y="946.021">check</tspan></text><use id="use25080" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(-195,0)" xlink:href="#text13760"/><use id="use25090" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(-260,0)" xlink:href="#text13760"/><text id="text2710" x="114.861" y="935.027" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan2714" x="114.861" y="935.027">ingress</tspan><tspan id="tspan4271" x="114.861" y="945.027">(qdisc)</tspan></text><use id="use3366" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(0,95)" xlink:href="#text3350"/><use id="use25072" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(-3e-6,-95)" xlink:href="#text13792"/><use id="use25076" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(0,-94.67847)" xlink:href="#text13756"/><use id="use25082" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(-195,-95)" xlink:href="#text13760"/><use id="use25084" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(-65,-95)" xlink:href="#text13760"/><use id="use25086" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(0,-95)" xlink:href="#text13760"/><use id="use25074" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(0,-95)" xlink:href="#text13768"/><text id="text3350" x="428.135" y="846.021" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="20" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="start" writing-mode="lr-tb" xml:space="preserve" style="text-align:start;line-height:100%"><tspan id="tspan3352" x="428.135" y="846.021" font-size="10">conntrack</tspan></text><text id="text3265" x="645.176" y="841.021" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan3267" x="645.176" y="841.021">routing</tspan><tspan id="tspan13842" x="645.176" y="851.021">decision</tspan></text><text id="text7650" x="644.702" y="905.085" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan7652" x="644.702" y="905.085">input</tspan></text><text id="text13756" x="579.705" y="933.44" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan13758" x="579.705" y="933.44">nat</tspan></text><text id="text13760" x="580.007" y="945.027" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan13762" x="580.007" y="945.027">prerouting</tspan></text><text id="text13768" x="514.892" y="932.796" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="9" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan13770" x="514.892" y="932.796">mangle</tspan></text><text id="text13836" x="645.176" y="936.021" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan13838" x="645.176" y="936.021">bridging</tspan><tspan id="tspan13840" x="645.176" y="946.021">decision</tspan></text><use id="use25078" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(-65,0)" xlink:href="#text13760"/><use id="use25144" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(-80.00001,-40)" xlink:href="#text13828"/><text id="text7706" x="725.317" y="946.082" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan7708" x="725.317" y="946.082">forward</tspan></text><text id="text13828" x="724.89" y="934.103" fill="#fff" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan13830" x="724.89" y="934.103" fill="#fff" fill-opacity="1">filter</tspan></text><use id="use25094" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(275,0)" xlink:href="#text13768"/><use id="use25096" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(275,-40)" xlink:href="#text13768"/><use id="use25098" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(275,-95)" xlink:href="#text13768"/><use id="use25119" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(64.999996,0)" xlink:href="#text7706"/><use id="use25121" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(65,-40)" xlink:href="#text7706"/><use id="use25123" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(65,-95)" xlink:href="#text7706"/><use id="use3419" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(130,0)" xlink:href="#text7706"/><use id="use3421" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(130,-40)" xlink:href="#text7706"/><use id="use3423" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(130,-95)" xlink:href="#text7706"/><text id="text3395" x="854.89" y="934.103" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan3397" x="854.89" y="934.103">filter</tspan></text><use id="use3878" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(0,-40)" xlink:href="#text3395"/><use id="use3882" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(0,-95)" xlink:href="#text3395"/><text id="use25102" x="999.892" y="837.651" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="9" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan3585" x="999.892" y="837.651">mangle</tspan></text><use id="use3860" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(-195,-90)" xlink:href="#text7686"/><use id="use3872" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(485,0)" xlink:href="#text13768"/><use id="use3876" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(144.99999,-130)" xlink:href="#text3395"/><use id="use3468" width="1510" height="1052" x="0" y="0" display="inline" transform="translate(485,-40)" xlink:href="#text13768"/><use id="use25136" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(64.999992,0)" xlink:href="#text12651"/><use id="use3868" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(65,-95)" xlink:href="#text12651"/><use id="use3472" width="1510" height="1052" x="0" y="0" display="inline" transform="translate(65,-40)" xlink:href="#text12651"/><use id="use25138" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(130,0)" xlink:href="#text12651"/><use id="use3808" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(485,0.52148)" xlink:href="#text13756"/><use id="use3810" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(485,-94.47852)" xlink:href="#text13756"/><use id="use3862" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(-130,-90)" xlink:href="#text7686"/><use id="use3866" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(485,-129.47852)" xlink:href="#text13756"/><use id="use3870" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(130,-95)" xlink:href="#text12651"/><use id="use3470" width="1510" height="1052" x="0" y="0" display="inline" transform="translate(485,-39.47852)" xlink:href="#text13756"/><use id="use3474" width="1510" height="1052" x="0" y="0" display="inline" transform="translate(130,-40)" xlink:href="#text12651"/><use id="use25127" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(-65,0)" xlink:href="#text7686"/><text id="text3830" x="1129.907" y="805.94" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan3834" x="1129.907" y="805.94">reroute</tspan><tspan id="tspan3838" x="1129.907" y="815.94">check</tspan></text><use id="use4375" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(810,-40)" xlink:href="#text13804"/><text id="text7686" x="1194.868" y="905.005" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan7688" x="1194.868" y="905.005">output</tspan></text><use id="use4373" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(470,-40)" xlink:href="#text13828"/><text id="text4381" x="1195.027" y="841.082" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan4383" x="1195.027" y="841.082">xfrm</tspan><tspan id="tspan4385" x="1195.027" y="851.082">lookup</tspan></text><use id="use3511" width="1510" height="1052" x="0" y="0" display="inline" transform="translate(939.99268,-40.02685)" xlink:href="#text13804"/><use id="use3513" width="1510" height="1052" x="0" y="0" display="inline" transform="translate(324.99268,-40.02685)" xlink:href="#text12651"/><use id="use3858" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(-195,-130)" xlink:href="#text7686"/><use id="use3886" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(615,-170)" xlink:href="#text13792"/><use id="use3850" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(615,-75)" xlink:href="#text3350"/><use id="use3856" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(-65,-130)" xlink:href="#text7686"/><use id="use3884" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(615,-170)" xlink:href="#text13768"/><text id="text4397" x="1065.027" y="706.082" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan4399" x="1065.027" y="706.082">xfrm</tspan><tspan id="tspan4401" x="1065.027" y="716.082">encode</tspan></text><use id="use3848" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(290,-75)" xlink:href="#text3265"/><text id="text12651" x="935.007" y="945.027" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan12653" x="935.007" y="945.027">postrouting</tspan></text><use id="use4377" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(615,0)" xlink:href="#text13804"/><use id="use25092" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(130,-135)" xlink:href="#text13768"/><use id="use25117" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(0,-95)" xlink:href="#text7650"/><text id="use3399" x="644.702" y="770.085" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan3533" x="644.702" y="770.085">input</tspan></text><text id="text3840" x="644.88" y="704.889" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="9" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan3842" x="644.88" y="704.889" font-size="9">xfrm/socket</tspan><tspan id="tspan3844" x="644.88" y="714.676" font-size="10">lookup</tspan></text><use id="use3888" width="1488" height="1052" x="0" y="0" display="inline" transform="translate(-210,-175)" xlink:href="#text3395"/><text id="text3299" x="784.663" y="635.085" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="9" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan3301" x="784.663" y="635.085" font-size="10">local</tspan><tspan id="tspan3864" x="784.663" y="645.085" font-size="10">process</tspan></text><text id="text3396" x="300.039" y="703.082" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="20" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan3398" x="300.039" y="703.082" font-size="10" text-anchor="middle" style="text-align:center">xfrm</tspan><tspan id="tspan3409" x="300.039" y="709.933" font-size="6" text-anchor="middle" style="text-align:center">(e.g. ipsec)</tspan><tspan id="tspan3400" x="300.039" y="719.082" font-size="10" text-anchor="middle" style="text-align:center">decode</tspan></text><text id="text2726" x="1340.01" y="935.146" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan2730" x="1340.01" y="935.146">egress</tspan><tspan id="tspan3319" x="1340.01" y="945.146">(qdisc)</tspan></text><text id="text3427" x="1404.878" y="935.146" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan3429" x="1404.878" y="935.146">interface</tspan><tspan id="tspan3874" x="1404.878" y="945.146">output</tspan></text><text id="text3343" x="141.501" y="682.491" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="8.124" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" transform="scale(0.81240384,1.2309149)" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan3345" x="141.501" y="682.491">taps (e.g.</tspan><tspan id="tspan4269" x="141.501" y="690.615">AF_PACKET)</tspan></text><text id="text3349" x="49.883" y="940.027" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan3351" x="49.883" y="940.027">(start)</tspan></text><text font-stretch="normal" style="text-align:center;line-height:100%" id="text4142" x="1729.541" y="687.31" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="8.124" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" transform="scale(0.81240384,1.2309149)" writing-mode="lr-tb" xml:space="preserve"><tspan id="tspan4146" x="1729.541" y="687.31">AF_PACKET</tspan></text></g><g id="layer5" display="inline" transform="translate(0,-525)"><path id="path3643" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 645.2,695 -0.2,-45 10,-10 105,0" display="inline"/><path id="path3625" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 1025,845 15,0" display="inline" opacity=".86"/><path id="path19737" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 1365,940 15,0" display="inline" opacity=".86"/><path id="path3627" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 1220,845 110,0 10,10 0,70" display="inline" opacity=".86"/><path id="path3501" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 1090,940 225,0" display="inline" opacity=".86"/><path id="path3509" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 1285,900 45,0 10,10" display="inline" opacity=".86"/><path id="path2715" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 1090,845 80,0" display="inline" opacity=".86"/><path id="path4316" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 1025,770 15,0" display="inline" opacity=".86"/><path id="path4320" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 1090,770 15,0" display="inline" opacity=".86"/><path id="path4322" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 1105,810 -15,0" display="inline" opacity=".86"/><path id="path4324" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 1040,810 -15,0" display="inline" opacity=".86"/><path id="path8695" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 1155,770 15,0 10,10 0,20 -10,10 -15,0" display="inline" opacity=".86"/><path id="path8713" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 880,900 95,0" display="inline" opacity=".86"/><path id="path3621" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 880,845 95,0" display="inline" opacity=".86"/><path id="path3792" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 975,810 -10,0 -10,10 0,15 10,10" display="inline" opacity=".86"/><path id="path4403" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 1195,830 0,-110 -10,-10 -95,0" display="inline" opacity=".86"/><path id="path3496" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 1090,900 15,0" display="inline" opacity=".86"/><path id="path3515" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 1025,900 15,0" display="inline" opacity=".86"/><path id="path4312" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 1155,900 15,0" display="inline" opacity=".86"/><path id="path4314" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 1220,900 15,0" display="inline" opacity=".86"/><path id="path3617" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 695,845 70,0" display="inline" opacity=".86"/><path id="path8711" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 750,940 15,0" display="inline" opacity=".86"/><path id="path12699" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 960,940 15,0" display="inline" opacity=".86"/><path id="path13750" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 955,835 0,55 10,10" display="inline" opacity=".86"/><path id="path8701" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 670,845 25,0 45,50 25,0" display="inline" opacity=".86"/><path id="path12703" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 1025,940 15,0" display="inline" opacity=".86"/><path id="path3391" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 815,940 15,0" display="inline" opacity=".86"/><path id="path3389" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 815,900 15,0" display="inline" opacity=".86"/><path id="path3476" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 880,940 30,0" display="inline" opacity=".86"/><path id="path4308" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 815,845 15,0" display="inline" opacity=".86"/><path id="path3613" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 540,845 15,0" display="inline" opacity=".86"/><path id="path12661" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 605,845 15,0" display="inline" opacity=".86"/><path id="path3356" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 475,845 15,0" display="inline" opacity=".86"/><path id="path3814" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 809.8,640 115,0 10,10 0.2,105" display="inline" opacity=".86"/><path id="path3394" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 620,710 -295,0" display="inline" opacity=".86"/><path id="path4405" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 1040,710 -30,0 -10,10 0,35" display="inline" opacity=".86"/><path id="path14826" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 345,940 15,0" display="inline" opacity=".86"/><path id="path14828" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 280,940 15,0" display="inline" opacity=".86"/><path id="path14842" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="M 255,925.52148 255,855 265,845" display="inline" opacity=".86"/><path id="path14862" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 140,940 15,0" display="inline" opacity=".86"/><path id="path3611" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 410,845 15,0" display="inline" opacity=".86"/><path id="path14876" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 205,940 25,0" display="inline" opacity=".86"/><path id="path14874" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 180,925 0,-70 10,-10 170,0" display="inline" opacity=".86"/><path id="path14824" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 410,940 15,0" display="inline" opacity=".86"/><path id="path2421" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 275,710 -10,0 -10,10 0,115 10,10" display="inline" opacity=".86"/><path id="path2720" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 75,940 15,0" display="inline" opacity=".86"/><path id="path8739" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 670,940 30,0" display="inline" opacity=".86"/><path id="path3364" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 475,940 15,0" display="inline" opacity=".86"/><path id="path3368" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 540,940 15,0" display="inline" opacity=".86"/><path id="path3370" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 605,940 15,0" display="inline" opacity=".86"/><path id="path4318" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 960,770 15,0" display="inline" opacity=".86"/><path id="path3639" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 645,830 0,-15" display="inline" opacity=".86"/><path id="path3372" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 645,790 0,-15" display="inline" opacity=".86"/><path id="path4310" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 645,750 0,-30" display="inline" opacity=".86"/><path id="path8703" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 645,885 0,-30" display="inline" opacity=".86"/><path id="path8719" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 645,925 0,-15" display="inline" opacity=".86"/><path id="path3341" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 50,925 0,-70 10,-10 30,0" display="inline" opacity=".86"/><text id="text3353" x="42.842" y="343.896" fill="#ff0048" fill-opacity="1" stroke="none" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" letter-spacing="0" text-anchor="start" word-spacing="0" writing-mode="lr-tb" xml:space="preserve" style="text-align:start;line-height:100%;-inkscape-font-specification:Arial">clone packet</text><path id="path4140" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 1365,935 c 0,0 8.5334,-5.51991 10,-10 6.8203,-20.8336 -16.8203,-44.1664 -10,-65 2.2,-6.72013 15,-15 15,-15" display="inline" opacity=".86"/><text id="text4154" x="2736.02" y="336.784" fill="#ff0048" fill-opacity="1" stroke="none" font-family="Arial" font-size="7.25" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" letter-spacing="0" text-anchor="start" word-spacing="0" writing-mode="lr-tb" xml:space="preserve" style="text-align:start;line-height:100%;-inkscape-font-specification:Arial">clone packet</text><path id="path4246" fill="none" stroke="#000" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-opacity="1" stroke-width="1.5" marker-end="url(#Arrow2Mend)" d="m 265,710 -140,0 -10,10 0,110" display="inline" opacity=".86"/><text id="text4252" x="150" y="705" fill="red" fill-opacity="1" stroke="none" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" letter-spacing="0" text-anchor="start" word-spacing="0" writing-mode="lr-tb" xml:space="preserve" style="text-align:start;line-height:100%;-inkscape-font-specification:Arial"><tspan id="tspan4254" x="150" y="705">clone packet</tspan></text><text id="text4259" x="980" y="695" fill="red" fill-opacity="1" stroke="none" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" letter-spacing="0" text-anchor="start" word-spacing="0" writing-mode="lr-tb" xml:space="preserve" style="text-align:start;line-height:100%;-inkscape-font-specification:Arial"><tspan id="tspan4261" x="980" y="695">no clone to</tspan><tspan id="tspan4263" x="980" y="705">AF_PACKET</tspan></text><text id="text3355" x="-920" y="45" fill="red" fill-opacity="1" stroke="none" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" letter-spacing="0" text-anchor="start" transform="matrix(0,-1,1,0,0,0)" word-spacing="0" writing-mode="lr-tb" xml:space="preserve" style="text-align:start;line-height:100%;-inkscape-font-specification:Arial"><tspan id="tspan3357" x="-920" y="45">clone packet</tspan></text><text id="text3359" x="-900" y="1360" fill="red" fill-opacity="1" stroke="none" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" letter-spacing="0" text-anchor="start" transform="matrix(0,-1,1,0,0,0)" word-spacing="0" writing-mode="lr-tb" xml:space="preserve" style="text-align:start;line-height:100%;-inkscape-font-specification:Arial"><tspan id="tspan3361" x="-900" y="1360">clone packet</tspan></text></g><g id="layer4" display="inline" transform="translate(0,-525)"><text font-style="normal" style="text-align:start;line-height:125%;-inkscape-font-specification:'Times New Roman,'" id="text26585" x="700" y="695" font-family="Times New Roman" font-size="10" font-stretch="normal" font-variant="normal" font-weight="normal" text-anchor="start" writing-mode="lr-tb" xml:space="preserve"><tspan font-style="normal" style="text-align:start;line-height:125%;-inkscape-font-specification:'Times New Roman,'" id="tspan26587" x="700" y="695" font-family="Times New Roman" font-size="10" font-stretch="normal" font-variant="normal" font-weight="normal" text-anchor="start" writing-mode="lr-tb">by Jan Engelhardt</tspan><tspan font-style="normal" style="text-align:start;line-height:125%;-inkscape-font-specification:'Times New Roman,'" id="tspan4244" x="700" y="707.5" font-family="Times New Roman" font-size="10" font-stretch="normal" font-variant="normal" font-weight="normal" text-anchor="start" writing-mode="lr-tb">(based in part on Joshua Snyder&apos;s graph)</tspan><tspan font-style="normal" style="text-align:start;line-height:125%;-inkscape-font-specification:'Times New Roman,'" id="tspan3402" x="700" y="720" font-family="Times New Roman" font-size="10" font-stretch="normal" font-variant="normal" font-weight="normal" text-anchor="start" writing-mode="lr-tb">Last updated 2014-Feb-28; Linux 2.6.36+</tspan></text><text id="text2719-7" x="700" y="760" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="12" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="start" writing-mode="lr-tb" xml:space="preserve" style="text-align:start;line-height:100%"><tspan id="tspan4298" x="700" y="760">* “security” table left</tspan><tspan id="tspan4334" x="700" y="772"> out for brevity</tspan><tspan id="tspan4336" x="700" y="784">* “nat” table only consulted</tspan><tspan id="tspan4338" x="700" y="796"> for “NEW” connections</tspan></text><text id="text26156" x="605" y="775" fill="#fff" fill-opacity=".502" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1" display="inline" font-family="Arial Black" font-size="36" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="end" writing-mode="lr-tb" xml:space="preserve" style="text-align:end;line-height:100%"><tspan id="tspan26158" x="605" y="775" font-size="32">Network Layer</tspan></text><text id="text26152" x="605" y="910" fill="#fff" fill-opacity=".502" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1" display="inline" font-family="Arial Black" font-size="36" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="end" writing-mode="lr-tb" xml:space="preserve" style="text-align:end;line-height:100%"><tspan id="tspan26154" x="605" y="910" font-size="32">Link Layer</tspan></text><text id="text13726" x="789.995" y="613.582" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan13728" x="789.995" y="613.582">FORWARD PATH</tspan></text><text id="text13730" x="1097.664" y="613.582" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan13732" x="1097.664" y="613.582">OUTPUT PATH</tspan></text><text id="text3421" x="605" y="700" fill="#fff" fill-opacity=".502" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1" display="inline" font-family="Arial Black" font-size="36" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="end" writing-mode="lr-tb" xml:space="preserve" style="text-align:end;line-height:100%"><tspan id="tspan3423" x="605" y="700" font-size="32">Protocol Layer</tspan></text><text id="text13738" x="449.939" y="613.582" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan13740" x="449.939" y="613.582">INPUT PATH</tspan></text><text id="text4100" x="605" y="650" fill="#fff" fill-opacity=".502" stroke="#000" stroke-linecap="butt" stroke-linejoin="miter" stroke-opacity="1" stroke-width="1" display="inline" font-family="Arial Black" font-size="36" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="end" writing-mode="lr-tb" xml:space="preserve" style="text-align:end;line-height:100%"><tspan id="tspan4102" x="605" y="650" font-size="32">Application Layer</tspan></text><text id="text26165" x="725.07" y="585.162" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Times New Roman" font-size="48" font-stretch="normal" font-style="italic" font-variant="normal" font-weight="normal" text-anchor="middle" writing-mode="lr-tb" xml:space="preserve" style="text-align:center;line-height:100%"><tspan id="tspan26167" x="725.07" y="585.162">Packet flow in Netfilter and General Networking</tspan></text><rect id="rect3423" width="20" height="10" x="25" y="680" fill="url(#linearGradient3425)" fill-opacity="1" fill-rule="evenodd" stroke="#000" stroke-dasharray="none" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="bevel" stroke-miterlimit="4" stroke-opacity="1" stroke-width=".25" display="inline"/><rect id="rect4396" width="20" height="10" x="25" y="660" fill="url(#linearGradient4398)" fill-opacity="1" fill-rule="evenodd" stroke="#000" stroke-dasharray="none" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="bevel" stroke-miterlimit="4" stroke-opacity="1" stroke-width=".25" display="inline"/><text id="text4400" x="50" y="690" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="start" writing-mode="lr-tb" xml:space="preserve" style="text-align:start;line-height:100%"><tspan id="tspan4402" x="50" y="690" font-size="16">bridge level</tspan></text><text id="text4404" x="50" y="635" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="start" writing-mode="lr-tb" xml:space="preserve" style="text-align:start;line-height:100%"><tspan id="tspan4406" x="50" y="635" font-size="16">basic set of filtering</tspan><tspan id="tspan3519" x="50" y="651" font-size="16">opportunities at the</tspan></text><rect id="rect3304" width="20" height="10" x="25" y="580" fill="url(#linearGradient3307)" fill-opacity="1" fill-rule="evenodd" stroke="#000" stroke-dasharray="none" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="bevel" stroke-miterlimit="4" stroke-opacity="1" stroke-width=".25" display="inline" rx="5.745" ry="4.814"/><text id="text3309" x="50" y="590" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="start" writing-mode="lr-tb" xml:space="preserve" style="text-align:start;line-height:100%"><tspan id="tspan3311" x="50" y="590" font-size="16">Other NF parts</tspan></text><rect id="rect4273" width="20" height="10" x="25" y="600" fill="url(#linearGradient4275)" fill-opacity="1" fill-rule="evenodd" stroke="#000" stroke-dasharray="none" stroke-dashoffset="0" stroke-linecap="butt" stroke-linejoin="bevel" stroke-miterlimit="4" stroke-opacity="1" stroke-width=".25" display="inline" rx="5.745" ry="4.814"/><text id="text4277" x="50" y="610" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="start" writing-mode="lr-tb" xml:space="preserve" style="text-align:start;line-height:100%"><tspan id="tspan4279" x="50" y="610" font-size="16">Other Networking</tspan></text><text id="text3368" x="50" y="670" fill="#000" fill-opacity="1" stroke="none" display="inline" font-family="Arial" font-size="10" font-stretch="normal" font-style="normal" font-variant="normal" font-weight="normal" text-anchor="start" writing-mode="lr-tb" xml:space="preserve" style="text-align:start;line-height:100%"><tspan id="tspan3372" x="50" y="670" font-size="16">network level</tspan></text></g></svg>